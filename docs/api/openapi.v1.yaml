openapi: 3.0.3
info:
  title: DevOps Learning Platform API
  version: 1.0.0
  description: |
    Versioned API contracts for serving learning content (skills, modules, labs, interview questions)
    with tagging, difficulty levels, and content versions.
servers:
  - url: https://api.devops-learning.example.com
paths:
  /api/v1/content/modules:
    get:
      summary: List learning modules
      parameters:
        - in: query
          name: tag
          schema: { type: string }
        - in: query
          name: difficulty
          schema:
            type: string
            enum: [beginner, intermediate, advanced]
        - in: query
          name: version
          schema: { type: string, example: "2026.02" }
        - in: query
          name: page
          schema: { type: integer, minimum: 1, default: 1 }
        - in: query
          name: pageSize
          schema: { type: integer, minimum: 1, maximum: 100, default: 20 }
      responses:
        '200':
          description: paginated modules
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedModulesResponse'
  /api/v1/content/modules/{moduleId}:
    get:
      summary: Get module details
      parameters:
        - in: path
          name: moduleId
          required: true
          schema: { type: string }
        - in: query
          name: version
          schema: { type: string }
      responses:
        '200':
          description: module details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Module'
        '404': { description: not found }
  /api/v1/content/labs:
    get:
      summary: List labs
      parameters:
        - in: query
          name: topic
          schema: { type: string }
        - in: query
          name: labType
          schema:
            type: string
            enum: [guided, break-fix]
        - in: query
          name: difficulty
          schema:
            type: string
            enum: [beginner, intermediate, advanced]
        - in: query
          name: tag
          schema: { type: string }
        - in: query
          name: version
          schema: { type: string }
      responses:
        '200':
          description: lab list
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Lab'
  /api/v1/content/interview-questions:
    get:
      summary: List interview questions
      parameters:
        - in: query
          name: role
          schema: { type: string }
        - in: query
          name: difficulty
          schema:
            type: string
            enum: [beginner, intermediate, advanced]
        - in: query
          name: tag
          schema: { type: string }
      responses:
        '200':
          description: question list
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/InterviewQuestion'
  /api/v1/content/tags:
    get:
      summary: List available tags
      responses:
        '200':
          description: tags
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: string

  /api/v1/ai/explain:
    post:
      summary: Explain a DevOps topic in simple terms
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                topic: { type: string }
                lessonText: { type: string }
      responses:
        '200':
          description: explanation
  /api/v1/ai/interview-questions:
    post:
      summary: Generate interview questions from a lesson
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                lessonTitle: { type: string }
                lessonText: { type: string }
      responses:
        '200':
          description: generated questions
  /api/v1/ai/real-world-scenarios:
    post:
      summary: Generate real-world scenario questions
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                topic: { type: string }
                difficulty: { type: string, enum: [beginner, intermediate, advanced] }
      responses:
        '200':
          description: scenario questions
  /api/v1/ai/detect-outdated:
    post:
      summary: Detect potentially outdated DevOps content
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                contentItems:
                  type: array
                  items:
                    type: object
                    properties:
                      title: { type: string }
                      body: { type: string }
                      lastReviewedAt: { type: string, format: date-time }
      responses:
        '200':
          description: outdated content findings

components:
  schemas:
    ContentVersion:
      type: object
      required: [version, status, publishedAt]
      properties:
        version: { type: string, example: "2026.02" }
        status: { type: string, enum: [draft, published, deprecated] }
        publishedAt: { type: string, format: date-time }
    Module:
      type: object
      required: [id, title, description, topic, difficulty, tags, version]
      properties:
        id: { type: string }
        title: { type: string }
        description: { type: string }
        topic: { type: string, example: "kubernetes" }
        difficulty: { type: string, enum: [beginner, intermediate, advanced] }
        tags:
          type: array
          items: { type: string }
        version:
          $ref: '#/components/schemas/ContentVersion'
        estimatedMinutes: { type: integer, minimum: 1 }
        sections:
          type: array
          items:
            type: object
            properties:
              heading: { type: string }
              body: { type: string }
    Lab:
      type: object
      required: [id, topic, title, difficulty, tags, version, objective]
      properties:
        id: { type: string }
        topic: { type: string }
        title: { type: string }
        labType: { type: string, enum: [guided, break-fix] }
        difficulty: { type: string, enum: [beginner, intermediate, advanced] }
        tags:
          type: array
          items: { type: string }
        version:
          $ref: '#/components/schemas/ContentVersion'
        objective: { type: string }
        architectureDiagramDescription: { type: string }
        intentionalMisconfiguration:
          type: array
          items: { type: string }
        steps:
          type: array
          items: { type: string }
        expectedOutput:
          type: array
          items: { type: string }
        commonFailureCases:
          type: array
          items: { type: string }
        sreTroubleshootingWorkflow:
          type: array
          items: { type: string }
        solutionExplanation: { type: string }
        cleanupSteps:
          type: array
          items: { type: string }
    InterviewQuestion:
      type: object
      required: [id, role, question, difficulty, tags, version]
      properties:
        id: { type: string }
        role: { type: string }
        question: { type: string }
        focus: { type: string }
        difficulty: { type: string, enum: [beginner, intermediate, advanced] }
        tags:
          type: array
          items: { type: string }
        version:
          $ref: '#/components/schemas/ContentVersion'
    PaginatedModulesResponse:
      type: object
      properties:
        page: { type: integer }
        pageSize: { type: integer }
        total: { type: integer }
        items:
          type: array
          items:
            $ref: '#/components/schemas/Module'
